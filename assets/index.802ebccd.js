var Qr=Object.defineProperty,Jr=Object.defineProperties;var ei=Object.getOwnPropertyDescriptors;var Ln=Object.getOwnPropertySymbols;var ti=Object.prototype.hasOwnProperty,ni=Object.prototype.propertyIsEnumerable;var kt=(e,t,n)=>t in e?Qr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Nn=(e,t)=>{for(var n in t||(t={}))ti.call(t,n)&&kt(e,n,t[n]);if(Ln)for(var n of Ln(t))ni.call(t,n)&&kt(e,n,t[n]);return e},jn=(e,t)=>Jr(e,ei(t));var ee=(e,t,n)=>(kt(e,typeof t!="symbol"?t+"":t,n),n);const ri=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}};ri();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var F=function(){return F=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},F.apply(this,arguments)};function Yt(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var L=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,V=Object.keys,q=Array.isArray;typeof Promise!="undefined"&&!L.Promise&&(L.Promise=Promise);function J(e,t){return typeof t!="object"||V(t).forEach(function(n){e[n]=t[n]}),e}var He=Object.getPrototypeOf,ii={}.hasOwnProperty;function ne(e,t){return ii.call(e,t)}function Be(e,t){typeof t=="function"&&(t=t(He(e))),(typeof Reflect=="undefined"?V:Reflect.ownKeys)(t).forEach(function(n){pe(e,n,t[n])})}var lr=Object.defineProperty;function pe(e,t,n,r){lr(e,t,J(n&&ne(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function ke(e){return{from:function(t){return e.prototype=Object.create(t.prototype),pe(e.prototype,"constructor",e),{extend:Be.bind(null,e.prototype)}}}}var ai=Object.getOwnPropertyDescriptor;function _n(e,t){var n=ai(e,t),r;return n||(r=He(e))&&_n(r,t)}var oi=[].slice;function Ot(e,t,n){return oi.call(e,t,n)}function fr(e,t){return t(e)}function Ne(e){if(!e)throw new Error("Assertion Failed")}function hr(e){L.setImmediate?setImmediate(e):setTimeout(e,0)}function dr(e,t){return e.reduce(function(n,r,i){var a=t(r,i);return a&&(n[a[0]]=a[1]),n},{})}function ui(e,t,n){try{e.apply(null,n)}catch(r){t&&t(r)}}function de(e,t){if(ne(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=de(e,t[r]);n.push(a)}return n}var o=t.indexOf(".");if(o!==-1){var u=e[t.substr(0,o)];return u===void 0?void 0:de(u,t.substr(o+1))}}function ie(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Ne(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)ie(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var o=t.substr(0,a),u=t.substr(a+1);if(u==="")n===void 0?q(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n;else{var s=e[o];(!s||!ne(e,o))&&(s=e[o]={}),ie(s,u,n)}}else n===void 0?q(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function si(e,t){typeof t=="string"?ie(e,t,void 0):"length"in t&&[].map.call(t,function(n){ie(e,n,void 0)})}function pr(e){var t={};for(var n in e)ne(e,n)&&(t[n]=e[n]);return t}var ci=[].concat;function vr(e){return ci.apply([],e)}var yr="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(vr([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return L[e]}),li=yr.map(function(e){return L[e]});dr(yr,function(e){return[e,!0]});var me=null;function Je(e){me=typeof WeakMap!="undefined"&&new WeakMap;var t=Ht(e);return me=null,t}function Ht(e){if(!e||typeof e!="object")return e;var t=me&&me.get(e);if(t)return t;if(q(e)){t=[],me&&me.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(Ht(e[n]))}else if(li.indexOf(e.constructor)>=0)t=e;else{var i=He(e);t=i===Object.prototype?{}:Object.create(i),me&&me.set(e,t);for(var a in e)ne(e,a)&&(t[a]=Ht(e[a]))}return t}var fi={}.toString;function Gt(e){return fi.call(e).slice(8,-1)}var $t=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator",hi=typeof $t=="symbol"?function(e){var t;return e!=null&&(t=e[$t])&&t.apply(e)}:function(){return null},De={};function le(e){var t,n,r,i;if(arguments.length===1){if(q(e))return e.slice();if(this===De&&typeof e=="string")return[e];if(i=hi(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var bn=typeof Symbol!="undefined"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ue=typeof location!="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function mr(e,t){ue=e,gr=t}var gr=function(){return!0},di=!new Error("").stack;function xe(){if(di)try{throw xe.arguments,new Error}catch(e){return e}return new Error}function Xt(e,t){var n=e.stack;return n?(t=t||0,n.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),n.split(`
`).slice(t).filter(gr).map(function(r){return`
`+r}).join("")):""}var pi=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],_r=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],wn=pi.concat(_r),vi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Fe(e,t){this._e=xe(),this.name=e,this.message=t}ke(Fe).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Xt(this._e,2))}},toString:function(){return this.name+": "+this.message}});function br(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function bt(e,t,n,r){this._e=xe(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=br(e,t)}ke(bt).from(Fe);function ze(e,t){this._e=xe(),this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=br(e,t)}ke(ze).from(Fe);var An=wn.reduce(function(e,t){return e[t]=t+"Error",e},{}),yi=Fe,B=wn.reduce(function(e,t){var n=t+"Error";function r(i,a){this._e=xe(),this.name=n,i?typeof i=="string"?(this.message=""+i+(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=vi[t]||n,this.inner=null)}return ke(r).from(yi),e[t]=r,e},{});B.Syntax=SyntaxError;B.Type=TypeError;B.Range=RangeError;var Vn=_r.reduce(function(e,t){return e[t+"Error"]=B[t],e},{});function mi(e,t){if(!e||e instanceof Fe||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Vn[e.name])return e;var n=new Vn[e.name](t||e.message,e);return"stack"in e&&pe(n,"stack",{get:function(){return this.inner.stack}}),n}var Dt=wn.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=B[t]),e},{});Dt.ModifyError=bt;Dt.DexieError=Fe;Dt.BulkError=ze;function U(){}function et(e){return e}function gi(e,t){return e==null||e===et?t:function(n){return t(e(n))}}function Ie(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function _i(e,t){return e===U?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Ie(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Ie(i,this.onerror):i),a!==void 0?a:n}}function bi(e,t){return e===U?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Ie(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Ie(r,this.onerror):r)}}function wi(e,t){return e===U?t:function(n){var r=e.apply(this,arguments);J(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Ie(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Ie(a,this.onerror):a),r===void 0?o===void 0?void 0:o:J(r,o)}}function Ai(e,t){return e===U?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function En(e,t){return e===U?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}var Ge={},Ei=100,Si=20,wr=100,Sn=typeof Promise=="undefined"?[]:function(){var e=Promise.resolve();if(typeof crypto=="undefined"||!crypto.subtle)return[e,He(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,He(t),e]}(),qt=Sn[0],wt=Sn[1],Zt=Sn[2],Ar=wt&&wt.then,dt=qt&&qt.constructor,Tn=!!Zt,Qt=!1,Ti=Zt?function(){Zt.then(ot)}:L.setImmediate?setImmediate.bind(null,ot):L.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){ot(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(ot,0)},$e=function(e,t){je.push([e,t]),At&&(Ti(),At=!1)},Jt=!0,At=!0,Se=[],pt=[],en=null,tn=et,Ke={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Yn,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(e){try{Yn(e[0],e[1])}catch{}})}},O=Ke,je=[],Te=0,vt=[];function R(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=U,this._lib=!1;var t=this._PSD=O;if(ue&&(this._stackHolder=xe(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==Ge)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&rn(this,this._value);return}this._state=null,this._value=null,++t.ref,Sr(this,e)}var nn={get:function(){var e=O,t=Et;function n(r,i){var a=this,o=!e.global&&(e!==O||t!==Et),u=o&&!ve(),s=new R(function(c,f){In(a,new Er(Tt(r,e,o,u),Tt(i,e,o,u),c,f,e))});return ue&&Rr(s,this),s}return n.prototype=Ge,n},set:function(e){pe(this,"then",e&&e.prototype===Ge?nn:{get:function(){return e},set:nn.set})}};Be(R.prototype,{then:nn,_then:function(e,t){In(this,new Er(null,null,e,t,O))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(r){return r instanceof t?n(r):yt(r)}):this.then(null,function(r){return r&&r.name===t?n(r):yt(r)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),yt(t)})},stack:{get:function(){if(this._stack)return this._stack;try{Qt=!0;var e=Ir(this,[],Si),t=e.join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Qt=!1}}},timeout:function(e,t){var n=this;return e<1/0?new R(function(r,i){var a=setTimeout(function(){return i(new B.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}});typeof Symbol!="undefined"&&Symbol.toStringTag&&pe(R.prototype,Symbol.toStringTag,"Dexie.Promise");Ke.env=xr();function Er(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}Be(R,{all:function(){var e=le.apply(null,arguments).map(St);return new R(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return R.resolve(i).then(function(o){e[a]=o,--r||t(e)},n)})})},resolve:function(e){if(e instanceof R)return e;if(e&&typeof e.then=="function")return new R(function(n,r){e.then(n,r)});var t=new R(Ge,!0,e);return Rr(t,en),t},reject:yt,race:function(){var e=le.apply(null,arguments).map(St);return new R(function(t,n){e.map(function(r){return R.resolve(r).then(t,n)})})},PSD:{get:function(){return O},set:function(e){return O=e}},totalEchoes:{get:function(){return Et}},newPSD:_e,usePSD:Me,scheduler:{get:function(){return $e},set:function(e){$e=e}},rejectionMapper:{get:function(){return tn},set:function(e){tn=e}},follow:function(e,t){return new R(function(n,r){return _e(function(i,a){var o=O;o.unhandleds=[],o.onunhandled=a,o.finalize=Ie(function(){var u=this;Ri(function(){u.unhandleds.length===0?i():a(u.unhandleds[0])})},o.finalize),e()},t,n,r)})}});dt&&(dt.allSettled&&pe(R,"allSettled",function(){var e=le.apply(null,arguments).map(St);return new R(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return R.resolve(i).then(function(o){return r[a]={status:"fulfilled",value:o}},function(o){return r[a]={status:"rejected",reason:o}}).then(function(){return--n||t(r)})})})}),dt.any&&typeof AggregateError!="undefined"&&pe(R,"any",function(){var e=le.apply(null,arguments).map(St);return new R(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,o){return R.resolve(a).then(function(u){return t(u)},function(u){i[o]=u,--r||n(new AggregateError(i))})})})}));function Sr(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&tt();n&&typeof n.then=="function"?Sr(e,function(i,a){n instanceof R?n._then(i,a):n.then(i,a)}):(e._state=!0,e._value=n,Tr(e)),r&&nt()}},rn.bind(null,e))}catch(n){rn(e,n)}}function rn(e,t){if(pt.push(t),e._state===null){var n=e._lib&&tt();t=tn(t),e._state=!1,e._value=t,ue&&t!==null&&typeof t=="object"&&!t._promise&&ui(function(){var r=_n(t,"stack");t._promise=e,pe(t,"stack",{get:function(){return Qt?r&&(r.get?r.get.apply(t):r.value):e.stack}})}),xi(e),Tr(e),n&&nt()}}function Tr(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)In(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),Te===0&&(++Te,$e(function(){--Te===0&&Rn()},[]))}function In(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Te,$e(Ii,[n,e,t])}function Ii(e,t,n){try{en=t;var r,i=t._value;t._state?r=e(i):(pt.length&&(pt=[]),r=e(i),pt.indexOf(i)===-1&&Ci(t)),n.resolve(r)}catch(a){n.reject(a)}finally{en=null,--Te===0&&Rn(),--n.psd.ref||n.psd.finalize()}}function Ir(e,t,n){if(t.length===n)return t;var r="";if(e._state===!1){var i=e._value,a,o;i!=null?(a=i.name||"Error",o=i.message||i,r=Xt(i,0)):(a=i,o=""),t.push(a+(o?": "+o:"")+r)}return ue&&(r=Xt(e._stackHolder,2),r&&t.indexOf(r)===-1&&t.push(r),e._prev&&Ir(e._prev,t,n)),t}function Rr(e,t){var n=t?t._numPrev+1:0;n<Ei&&(e._prev=t,e._numPrev=n)}function ot(){tt()&&nt()}function tt(){var e=Jt;return Jt=!1,At=!1,e}function nt(){var e,t,n;do for(;je.length>0;)for(e=je,je=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(je.length>0);Jt=!0,At=!0}function Rn(){var e=Se;Se=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=vt.slice(0),n=t.length;n;)t[--n]()}function Ri(e){function t(){e(),vt.splice(vt.indexOf(t),1)}vt.push(t),++Te,$e(function(){--Te===0&&Rn()},[])}function xi(e){Se.some(function(t){return t._value===e._value})||Se.push(e)}function Ci(e){for(var t=Se.length;t;)if(Se[--t]._value===e._value){Se.splice(t,1);return}}function yt(e){return new R(Ge,!1,e)}function N(e,t){var n=O;return function(){var r=tt(),i=O;try{return be(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{be(i,!1),r&&nt()}}}var X={awaits:0,echoes:0,id:0},Oi=0,mt=[],Ft=0,Et=0,Di=0;function _e(e,t,n,r){var i=O,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++Di;var o=Ke.env;a.env=Tn?{Promise:R,PromiseProp:{value:R,configurable:!0,writable:!0},all:R.all,race:R.race,allSettled:R.allSettled,any:R.any,resolve:R.resolve,reject:R.reject,nthen:zn(o.nthen,a),gthen:zn(o.gthen,a)}:{},t&&J(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=Me(a,e,n,r);return a.ref===0&&a.finalize(),u}function Pe(){return X.id||(X.id=++Oi),++X.awaits,X.echoes+=wr,X.id}function ve(){return X.awaits?(--X.awaits===0&&(X.id=0),X.echoes=X.awaits*wr,!0):!1}(""+Ar).indexOf("[native code]")===-1&&(Pe=ve=U);function St(e){return X.echoes&&e&&e.constructor===dt?(Pe(),e.then(function(t){return ve(),t},function(t){return ve(),W(t)})):e}function Ki(e){++Et,(!X.echoes||--X.echoes===0)&&(X.echoes=X.id=0),mt.push(O),be(e,!0)}function Bi(){var e=mt[mt.length-1];mt.pop(),be(e,!1)}function be(e,t){var n=O;if((t?X.echoes&&(!Ft++||e!==O):Ft&&(!--Ft||e!==O))&&Cr(t?Ki.bind(null,e):Bi),e!==O&&(O=e,n===Ke&&(Ke.env=xr()),Tn)){var r=Ke.env.Promise,i=e.env;wt.then=i.nthen,r.prototype.then=i.gthen,(n.global||e.global)&&(Object.defineProperty(L,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function xr(){var e=L.Promise;return Tn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(L,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:wt.then,gthen:e.prototype.then}:{}}function Me(e,t,n,r,i){var a=O;try{return be(e,!0),t(n,r,i)}finally{be(a,!1)}}function Cr(e){Ar.call(qt,e)}function Tt(e,t,n,r){return typeof e!="function"?e:function(){var i=O;n&&Pe(),be(t,!0);try{return e.apply(this,arguments)}finally{be(i,!1),r&&Cr(ve)}}}function zn(e,t){return function(n,r){return e.call(this,Tt(n,t),Tt(r,t))}}var Wn="unhandledrejection";function Yn(e,t){var n;try{n=t.onuncatched(e)}catch{}if(n!==!1)try{var r,i={promise:t,reason:e};if(L.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(Wn,!0,!0),J(r,i)):L.CustomEvent&&(r=new CustomEvent(Wn,{detail:i}),J(r,i)),r&&L.dispatchEvent&&(dispatchEvent(r),!L.PromiseRejectionEvent&&L.onunhandledrejection))try{L.onunhandledrejection(r)}catch{}ue&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch{}}var W=R.reject;function an(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!O.letThrough&&!e._vip){if(e._state.openComplete)return W(new B.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return W(new B.DatabaseClosed);e.open().catch(U)}return e._state.dbReadyPromise.then(function(){return an(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===An.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return an(e,t,n,r)})):W(a)}return i._promise(t,function(a,o){return _e(function(){return O.trans=i,r(a,o,i)})}).then(function(a){return i._completion.then(function(){return a})})}}var Hn="3.2.2",Ee=String.fromCharCode(65535),on=-1/0,se="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Or="String expected.",We=[],Kt=typeof navigator!="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),ki=Kt,Fi=Kt,Dr=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)},Bt="__dbnames",Pt="readonly",Mt="readwrite";function Re(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Kr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ut(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=Je(t),delete t[e]),t}:function(t){return t}}var Pi=function(){function e(){}return e.prototype._trans=function(t,n,r){var i=this._tx||O.trans,a=this.name;function o(s,c,f){if(!f.schema[a])throw new B.NotFound("Table "+a+" not part of transaction");return n(f.idbtrans,f)}var u=tt();try{return i&&i.db===this.db?i===O.trans?i._promise(t,o,r):_e(function(){return i._promise(t,o,r)},{trans:i,transless:O.transless||O}):an(this.db,t,[this.name],o)}finally{u&&nt()}},e.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:t}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(q(t))return new this.db.WhereClause(this,"["+t.join("+")+"]");var n=V(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(f){return f.compound&&n.every(function(l){return f.keyPath.indexOf(l)>=0})&&f.keyPath.every(function(l){return n.indexOf(l)>=0})})[0];if(r&&this.db._maxKey!==Ee)return this.where(r.name).equals(r.keyPath.map(function(f){return t[f]}));!r&&ue&&console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,a=this.db._deps.indexedDB;function o(f,l){try{return a.cmp(f,l)===0}catch{return!1}}var u=n.reduce(function(f,l){var h=f[0],m=f[1],p=i[l],d=t[l];return[h||p,h||!p?Re(m,p&&p.multi?function(y){var w=de(y,l);return q(w)&&w.some(function(A){return o(d,A)})}:function(y){return o(d,de(y,l))}):m]},[null,null]),s=u[0],c=u[1];return s?this.where(s.name).equals(t[s.keyPath]).filter(c):r?this.filter(c):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,q(t)?"["+t.join("+")+"]":t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){this.schema.mappedClass=t;var n=function(r){if(!r)return r;var i=Object.create(t.prototype);for(var a in r)if(ne(r,a))try{i[a]=r[a]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),t},e.prototype.defineClass=function(){function t(n){J(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=t;return o&&a&&(u=ut(o)(t)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:n!=null?[n]:null,values:[u]})}).then(function(s){return s.numFailures?R.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{ie(t,o,s)}catch{}return s})},e.prototype.update=function(t,n){if(typeof t=="object"&&!q(t)){var r=de(t,this.schema.primKey.keyPath);if(r===void 0)return W(new B.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?V(n).forEach(function(i){ie(t,i,n[i])}):n(t,{value:t,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=t;return o&&a&&(u=ut(o)(t)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[u],keys:n!=null?[n]:null})}).then(function(s){return s.numFailures?R.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{ie(t,o,s)}catch{}return s})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]})}).then(function(r){return r.numFailures?R.reject(r.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:Kr})}).then(function(n){return n.numFailures?R.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},e.prototype.bulkAdd=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,c=s.auto,f=s.keyPath;if(f&&a)throw new B.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");var l=t.length,h=f&&c?t.map(ut(f)):t;return i.core.mutate({trans:u,type:"add",keys:a,values:h,wantResults:o}).then(function(m){var p=m.numFailures,d=m.results,y=m.lastResult,w=m.failures,A=o?d:y;if(p===0)return A;throw new ze(i.name+".bulkAdd(): "+p+" of "+l+" operations failed",w)})})},e.prototype.bulkPut=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,c=s.auto,f=s.keyPath;if(f&&a)throw new B.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");var l=t.length,h=f&&c?t.map(ut(f)):t;return i.core.mutate({trans:u,type:"put",keys:a,values:h,wantResults:o}).then(function(m){var p=m.numFailures,d=m.results,y=m.lastResult,w=m.failures,A=o?d:y;if(p===0)return A;throw new ze(i.name+".bulkPut(): "+p+" of "+l+" operations failed",w)})})},e.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:t})}).then(function(i){var a=i.numFailures,o=i.lastResult,u=i.failures;if(a===0)return o;throw new ze(n.name+".bulkDelete(): "+a+" of "+r+" operations failed",u)})},e}();function rt(e){var t={},n=function(u,s){if(s){for(var c=arguments.length,f=new Array(c-1);--c;)f[c-1]=arguments[c];return t[u].subscribe.apply(null,f),e}else if(typeof u=="string")return t[u]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(u,s,c){if(typeof u=="object")return o(u);s||(s=Ai),c||(c=U);var f={subscribers:[],fire:c,subscribe:function(l){f.subscribers.indexOf(l)===-1&&(f.subscribers.push(l),f.fire=s(f.fire,l))},unsubscribe:function(l){f.subscribers=f.subscribers.filter(function(h){return h!==l}),f.fire=f.subscribers.reduce(s,c)}};return t[u]=n[u]=f,f}function o(u){V(u).forEach(function(s){var c=u[s];if(q(c))a(s,u[s][0],u[s][1]);else if(c==="asap")var f=a(s,et,function(){for(var h=arguments.length,m=new Array(h);h--;)m[h]=arguments[h];f.subscribers.forEach(function(p){hr(function(){p.apply(null,m)})})});else throw new B.InvalidArgument("Invalid event config")})}}function it(e,t){return ke(t).from({prototype:e}),t}function Mi(e){return it(Pi.prototype,function(n,r,i){this.db=e,this._tx=i,this.name=n,this.schema=r,this.hook=e._allTables[n]?e._allTables[n].hook:rt(null,{creating:[_i,U],reading:[gi,et],updating:[wi,U],deleting:[bi,U]})})}function Ce(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Ut(e,t){e.filter=Re(e.filter,t)}function Lt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Re(r(),t())}:t,e.justLimit=n&&!r}function Ui(e,t){e.isMatch=Re(e.isMatch,t)}function gt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new B.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Gn(e,t,n){var r=gt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function st(e,t,n,r){var i=e.replayFilter?Re(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},o=function(u,s,c){if(!i||i(s,c,function(h){return s.stop(h)},function(h){return s.fail(h)})){var f=s.primaryKey,l=""+f;l==="[object ArrayBuffer]"&&(l=""+new Uint8Array(f)),ne(a,l)||(a[l]=!0,t(u,s,c))}};return Promise.all([e.or._iterate(o,n),$n(Gn(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}else return $n(Gn(e,r,n),Re(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function $n(e,t,n,r){var i=r?function(o,u,s){return n(r(o),u,s)}:n,a=N(i);return e.then(function(o){if(o)return o.start(function(){var u=function(){return o.continue()};(!t||t(o,function(s){return u=s},function(s){o.stop(s),u=U},function(s){o.fail(s),u=U}))&&a(o.value,o,function(s){return u=s}),u()})})}function Q(e,t){try{var n=Xn(e),r=Xn(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Ni(qn(e),qn(t));case"Array":return Li(e,t)}}catch{}return NaN}function Li(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a){var o=Q(e[a],t[a]);if(o!==0)return o}return n===r?0:n<r?-1:1}function Ni(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===r?0:n<r?-1:1}function Xn(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=Gt(e);return n==="ArrayBuffer"?"binary":n}function qn(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var ji=function(){function e(){}return e.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,W.bind(null,r.error)):r.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,W.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=Re(n.algorithm,t)},e.prototype._iterate=function(t,n){return st(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&J(r,t),n._ctx=r,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return st(n,t,r,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(Ce(i,!0))return a.count({trans:r,query:{index:gt(i,a.schema),range:i.range}}).then(function(u){return Math.min(u,i.limit)});var o=0;return st(i,function(){return++o,!1},r,a).then(function(){return o})}).then(t)},e.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],a=r.length-1;function o(c,f){return f?o(c[r[f]],f-1):c[i]}var u=this._ctx.dir==="next"?1:-1;function s(c,f){var l=o(c,a),h=o(f,a);return l<h?-u:l>h?u:0}return this.toArray(function(c){return c.sort(s)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Ce(i,!0)&&i.limit>0){var a=i.valueMapper,o=gt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then(function(s){var c=s.result;return a?c.map(a):c})}else{var u=[];return st(i,function(s){return u.push(s)},r,i.table.core).then(function(){return u})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,Ce(n)?Lt(n,function(){var r=t;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):Lt(n,function(){var r=t;return function(){return--r<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Lt(this._ctx,function(){var n=t;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},e.prototype.until=function(t,n){return Ut(this._ctx,function(r,i,a){return t(r.value)?(i(a),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return Ut(this._ctx,function(n){return t(n.value)}),Ui(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&Ce(n,!0)&&n.limit>0)return this._read(function(i){var a=gt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){var a=i.result;return a}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return Ut(this._ctx,function(i){var a=i.primaryKey.toString(),o=ne(r,a);return r[a]=!0,!o}),this},e.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){var a;if(typeof t=="function")a=t;else{var o=V(t),u=o.length;a=function(w){for(var A=!1,b=0;b<u;++b){var _=o[b],v=t[_];de(w,_)!==v&&(ie(w,_,v),A=!0)}return A}}var s=r.table.core,c=s.schema.primaryKey,f=c.outbound,l=c.extractKey,h=n.db._options.modifyChunkSize||200,m=[],p=0,d=[],y=function(w,A){var b=A.failures,_=A.numFailures;p+=w-_;for(var v=0,E=V(b);v<E.length;v++){var C=E[v];m.push(b[C])}};return n.clone().primaryKeys().then(function(w){var A=function(b){var _=Math.min(h,w.length-b);return s.getMany({trans:i,keys:w.slice(b,b+_),cache:"immutable"}).then(function(v){for(var E=[],C=[],I=f?[]:null,D=[],k=0;k<_;++k){var M=v[k],g={value:Je(M),primKey:w[b+k]};a.call(g,g.value,g)!==!1&&(g.value==null?D.push(w[b+k]):!f&&Q(l(M),l(g.value))!==0?(D.push(w[b+k]),E.push(g.value)):(C.push(g.value),f&&I.push(w[b+k])))}var S=Ce(r)&&r.limit===1/0&&(typeof t!="function"||t===Nt)&&{index:r.index,range:r.range};return Promise.resolve(E.length>0&&s.mutate({trans:i,type:"add",values:E}).then(function(K){for(var T in K.failures)D.splice(parseInt(T),1);y(E.length,K)})).then(function(){return(C.length>0||S&&typeof t=="object")&&s.mutate({trans:i,type:"put",keys:I,values:C,criteria:S,changeSpec:typeof t!="function"&&t}).then(function(K){return y(C.length,K)})}).then(function(){return(D.length>0||S&&t===Nt)&&s.mutate({trans:i,type:"delete",keys:D,criteria:S}).then(function(K){return y(D.length,K)})}).then(function(){return w.length>b+_&&A(b+h)})})};return A(0).then(function(){if(m.length>0)throw new bt("Error modifying one or more objects",m,p,d);return w.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return Ce(t)&&(t.isPrimKey&&!Fi||n.type===3)?this._write(function(r){var i=t.table.core.schema.primaryKey,a=n;return t.table.core.count({trans:r,query:{index:i,range:a}}).then(function(o){return t.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(u){var s=u.failures;u.lastResult,u.results;var c=u.numFailures;if(c)throw new bt("Could not delete some values",Object.keys(s).map(function(f){return s[f]}),o-c);return o-c})})}):this.modify(Nt)},e}(),Nt=function(e,t){return t.value=null};function Vi(e){return it(ji.prototype,function(n,r){this.db=e;var i=Kr,a=null;if(r)try{i=r()}catch(c){a=c}var o=n._ctx,u=o.table,s=u.hook.reading.fire;this._ctx={table:u,index:o.index,isPrimKey:!o.index||u.schema.primKey.keyPath&&o.index===u.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:o.or,valueMapper:s!==et?s:null}})}function zi(e,t){return e<t?-1:e===t?0:1}function Wi(e,t){return e>t?-1:e===t?0:1}function te(e,t,n){var r=e instanceof kr?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Oe(e){return new e.Collection(e,function(){return Br("")}).limit(0)}function Yi(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function Hi(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function Gi(e,t,n,r,i,a){for(var o=Math.min(e.length,r.length),u=-1,s=0;s<o;++s){var c=t[s];if(c!==r[s])return i(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;i(e[s],c)<0&&(u=s)}return o<r.length&&a==="next"?e+n.substr(e.length):o<e.length&&a==="prev"?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function ct(e,t,n,r){var i,a,o,u,s,c,f,l=n.length;if(!n.every(function(d){return typeof d=="string"}))return te(e,Or);function h(d){i=Yi(d),a=Hi(d),o=d==="next"?zi:Wi;var y=n.map(function(w){return{lower:a(w),upper:i(w)}}).sort(function(w,A){return o(w.lower,A.lower)});u=y.map(function(w){return w.upper}),s=y.map(function(w){return w.lower}),c=d,f=d==="next"?"":r}h("next");var m=new e.Collection(e,function(){return ye(u[0],s[l-1]+r)});m._ondirectionchange=function(d){h(d)};var p=0;return m._addAlgorithm(function(d,y,w){var A=d.key;if(typeof A!="string")return!1;var b=a(A);if(t(b,s,p))return!0;for(var _=null,v=p;v<l;++v){var E=Gi(A,b,u[v],s[v],o,c);E===null&&_===null?p=v+1:(_===null||o(_,E)>0)&&(_=E)}return y(_!==null?function(){d.continue(_+f)}:w),!1}),m}function ye(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Br(e){return{type:1,lower:e,upper:e}}var kr=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||i)&&!(r&&i)?Oe(this):new this.Collection(this,function(){return ye(t,n,!r,!i)})}catch{return te(this,se)}},e.prototype.equals=function(t){return t==null?te(this,se):new this.Collection(this,function(){return Br(t)})},e.prototype.above=function(t){return t==null?te(this,se):new this.Collection(this,function(){return ye(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?te(this,se):new this.Collection(this,function(){return ye(t,void 0,!1)})},e.prototype.below=function(t){return t==null?te(this,se):new this.Collection(this,function(){return ye(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?te(this,se):new this.Collection(this,function(){return ye(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?te(this,Or):this.between(t,t+Ee,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):ct(this,function(n,r){return n.indexOf(r[0])===0},[t],Ee)},e.prototype.equalsIgnoreCase=function(t){return ct(this,function(n,r){return n===r[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=le.apply(De,arguments);return t.length===0?Oe(this):ct(this,function(n,r){return r.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=le.apply(De,arguments);return t.length===0?Oe(this):ct(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},t,Ee)},e.prototype.anyOf=function(){var t=this,n=le.apply(De,arguments),r=this._cmp;try{n.sort(r)}catch{return te(this,se)}if(n.length===0)return Oe(this);var i=new this.Collection(this,function(){return ye(n[0],n[n.length-1])});i._ondirectionchange=function(o){r=o==="next"?t._ascending:t._descending,n.sort(r)};var a=0;return i._addAlgorithm(function(o,u,s){for(var c=o.key;r(c,n[a])>0;)if(++a,a===n.length)return u(s),!1;return r(c,n[a])===0?!0:(u(function(){o.continue(n[a])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[on,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=le.apply(De,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return te(this,se)}var n=t.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[on,i]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,a=this._ascending,o=this._descending,u=this._min,s=this._max;if(t.length===0)return Oe(this);if(!t.every(function(v){return v[0]!==void 0&&v[1]!==void 0&&a(v[0],v[1])<=0}))return te(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",B.InvalidArgument);var c=!n||n.includeLowers!==!1,f=n&&n.includeUppers===!0;function l(v,E){for(var C=0,I=v.length;C<I;++C){var D=v[C];if(i(E[0],D[1])<0&&i(E[1],D[0])>0){D[0]=u(D[0],E[0]),D[1]=s(D[1],E[1]);break}}return C===I&&v.push(E),v}var h=a;function m(v,E){return h(v[0],E[0])}var p;try{p=t.reduce(l,[]),p.sort(m)}catch{return te(this,se)}var d=0,y=f?function(v){return a(v,p[d][1])>0}:function(v){return a(v,p[d][1])>=0},w=c?function(v){return o(v,p[d][0])>0}:function(v){return o(v,p[d][0])>=0};function A(v){return!y(v)&&!w(v)}var b=y,_=new this.Collection(this,function(){return ye(p[0][0],p[p.length-1][1],!c,!f)});return _._ondirectionchange=function(v){v==="next"?(b=y,h=a):(b=w,h=o),p.sort(m)},_._addAlgorithm(function(v,E,C){for(var I=v.key;b(I);)if(++d,d===p.length)return E(C),!1;return A(I)?!0:(r._cmp(I,p[d][1])===0||r._cmp(I,p[d][0])===0||E(function(){h===a?v.continue(p[d][0]):v.continue(p[d][1])}),!1)}),_},e.prototype.startsWithAnyOf=function(){var t=le.apply(De,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?Oe(this):this.inAnyRange(t.map(function(n){return[n,n+Ee]})):te(this,"startsWithAnyOf() only works with strings")},e}();function $i(e){return it(kr.prototype,function(n,r,i){this.db=e,this._ctx={table:n,index:r===":id"?null:r,or:i};var a=e._deps.indexedDB;if(!a)throw new B.MissingAPI;this._cmp=this._ascending=a.cmp.bind(a),this._descending=function(o,u){return a.cmp(u,o)},this._max=function(o,u){return a.cmp(o,u)>0?o:u},this._min=function(o,u){return a.cmp(o,u)<0?o:u},this._IDBKeyRange=e._deps.IDBKeyRange})}function oe(e){return N(function(t){return Xe(t),e(t.target.error),!1})}function Xe(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var qe="storagemutated",ge="x-storagemutated-1",we=rt(null,qe),Xi=function(){function e(){}return e.prototype._lock=function(){return Ne(!O.global),++this._reculock,this._reculock===1&&!O.global&&(O.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Ne(!O.global),--this._reculock===0)for(O.global||(O.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Me(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&O.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(Ne(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new B.DatabaseClosed(i);case"MissingAPIError":throw new B.MissingAPI(i.message,i);default:throw new B.OpenFailed(i)}if(!this.active)throw new B.TransactionInactive;return Ne(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=N(function(a){Xe(a),n._reject(t.error)}),t.onabort=N(function(a){Xe(a),n.active&&n._reject(new B.Abort(t.error)),n.active=!1,n.on("abort").fire(a)}),t.oncomplete=N(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&we.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,r){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return W(new B.ReadOnly("Transaction is readonly"));if(!this.active)return W(new B.TransactionInactive);if(this._locked())return new R(function(o,u){i._blockedFuncs.push([function(){i._promise(t,n,r).then(o,u)},O])});if(r)return _e(function(){var o=new R(function(u,s){i._lock();var c=n(u,s,i);c&&c.then&&c.then(u,s)});return o.finally(function(){return i._unlock()}),o._lib=!0,o});var a=new R(function(o,u){var s=n(o,u,i);s&&s.then&&s.then(o,u)});return a._lib=!0,a},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),r=R.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var a=n._waitingFor;return new R(function(o,u){r.then(function(s){return n._waitingQueue.push(N(o.bind(null,s)))},function(s){return n._waitingQueue.push(N(u.bind(null,s)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new B.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(ne(n,t))return n[t];var r=this.schema[t];if(!r)throw new B.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},e}();function qi(e){return it(Xi.prototype,function(n,r,i,a,o){var u=this;this.db=e,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=rt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new R(function(s,c){u._resolve=s,u._reject=c}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(s){var c=u.active;return u.active=!1,u.on.error.fire(s),u.parent?u.parent._reject(s):c&&u.idbtrans&&u.idbtrans.abort(),W(s)})})}function un(e,t,n,r,i,a,o){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+Fr(t)}}function Fr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Pr(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:dr(n,function(r){return[r.name,r]})}}function Zi(e){return e.length===1?e[0]:e}var Ze=function(e){try{return e.only([[]]),Ze=function(){return[[]]},[[]]}catch{return Ze=function(){return Ee},Ee}};function sn(e){return e==null?function(){}:typeof e=="string"?Qi(e):function(t){return de(t,e)}}function Qi(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return de(n,e)}}function Zn(e){return[].slice.call(e)}var Ji=0;function Ye(e){return e==null?":id":typeof e=="string"?e:"["+e.join("+")+"]"}function ea(e,t,n){function r(l,h){var m=Zn(l.objectStoreNames);return{schema:{name:l.name,tables:m.map(function(p){return h.objectStore(p)}).map(function(p){var d=p.keyPath,y=p.autoIncrement,w=q(d),A=d==null,b={},_={name:p.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:A,compound:w,keyPath:d,autoIncrement:y,unique:!0,extractKey:sn(d)},indexes:Zn(p.indexNames).map(function(v){return p.index(v)}).map(function(v){var E=v.name,C=v.unique,I=v.multiEntry,D=v.keyPath,k=q(D),M={name:E,compound:k,keyPath:D,unique:C,multiEntry:I,extractKey:sn(D)};return b[Ye(D)]=M,M}),getIndexByKeyPath:function(v){return b[Ye(v)]}};return b[":id"]=_.primaryKey,d!=null&&(b[Ye(d)]=_.primaryKey),_})},hasGetAll:m.length>0&&"getAll"in h.objectStore(m[0])&&!(typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var h=l.lower,m=l.upper,p=l.lowerOpen,d=l.upperOpen,y=h===void 0?m===void 0?null:t.upperBound(m,!!d):m===void 0?t.lowerBound(h,!!p):t.bound(h,m,!!p,!!d);return y}function a(l){var h=l.name;function m(y){var w=y.trans,A=y.type,b=y.keys,_=y.values,v=y.range;return new Promise(function(E,C){E=N(E);var I=w.objectStore(h),D=I.keyPath==null,k=A==="put"||A==="add";if(!k&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var M=(b||_||{length:1}).length;if(b&&_&&b.length!==_.length)throw new Error("Given keys array must have same length as given values array.");if(M===0)return E({numFailures:0,failures:{},results:[],lastResult:void 0});var g,S=[],K=[],T=0,P=function(Y){++T,Xe(Y)};if(A==="deleteRange"){if(v.type===4)return E({numFailures:T,failures:K,results:[],lastResult:void 0});v.type===3?S.push(g=I.clear()):S.push(g=I.delete(i(v)))}else{var j=k?D?[_,b]:[_,null]:[b,null],Z=j[0],H=j[1];if(k)for(var $=0;$<M;++$)S.push(g=H&&H[$]!==void 0?I[A](Z[$],H[$]):I[A](Z[$])),g.onerror=P;else for(var $=0;$<M;++$)S.push(g=I[A](Z[$])),g.onerror=P}var G=function(Y){var ae=Y.target.result;S.forEach(function(re,at){return re.error!=null&&(K[at]=re.error)}),E({numFailures:T,failures:K,results:A==="delete"?b:S.map(function(re){return re.result}),lastResult:ae})};g.onerror=function(Y){P(Y),G(Y)},g.onsuccess=G})}function p(y){var w=y.trans,A=y.values,b=y.query,_=y.reverse,v=y.unique;return new Promise(function(E,C){E=N(E);var I=b.index,D=b.range,k=w.objectStore(h),M=I.isPrimaryKey?k:k.index(I.name),g=_?v?"prevunique":"prev":v?"nextunique":"next",S=A||!("openKeyCursor"in M)?M.openCursor(i(D),g):M.openKeyCursor(i(D),g);S.onerror=oe(C),S.onsuccess=N(function(K){var T=S.result;if(!T){E(null);return}T.___id=++Ji,T.done=!1;var P=T.continue.bind(T),j=T.continuePrimaryKey;j&&(j=j.bind(T));var Z=T.advance.bind(T),H=function(){throw new Error("Cursor not started")},$=function(){throw new Error("Cursor not stopped")};T.trans=w,T.stop=T.continue=T.continuePrimaryKey=T.advance=H,T.fail=N(C),T.next=function(){var G=this,Y=1;return this.start(function(){return Y--?G.continue():G.stop()}).then(function(){return G})},T.start=function(G){var Y=new Promise(function(re,at){re=N(re),S.onerror=oe(at),T.fail=at,T.stop=function(Zr){T.stop=T.continue=T.continuePrimaryKey=T.advance=$,re(Zr)}}),ae=function(){if(S.result)try{G()}catch(re){T.fail(re)}else T.done=!0,T.start=function(){throw new Error("Cursor behind last entry")},T.stop()};return S.onsuccess=N(function(re){S.onsuccess=ae,ae()}),T.continue=P,T.continuePrimaryKey=j,T.advance=Z,ae(),Y},E(T)},C)})}function d(y){return function(w){return new Promise(function(A,b){A=N(A);var _=w.trans,v=w.values,E=w.limit,C=w.query,I=E===1/0?void 0:E,D=C.index,k=C.range,M=_.objectStore(h),g=D.isPrimaryKey?M:M.index(D.name),S=i(k);if(E===0)return A({result:[]});if(y){var K=v?g.getAll(S,I):g.getAllKeys(S,I);K.onsuccess=function(Z){return A({result:Z.target.result})},K.onerror=oe(b)}else{var T=0,P=v||!("openKeyCursor"in g)?g.openCursor(S):g.openKeyCursor(S),j=[];P.onsuccess=function(Z){var H=P.result;if(!H)return A({result:j});if(j.push(v?H.value:H.primaryKey),++T===E)return A({result:j});H.continue()},P.onerror=oe(b)}})}}return{name:h,schema:l,mutate:m,getMany:function(y){var w=y.trans,A=y.keys;return new Promise(function(b,_){b=N(b);for(var v=w.objectStore(h),E=A.length,C=new Array(E),I=0,D=0,k,M=function(T){var P=T.target;(C[P._pos]=P.result)!=null,++D===I&&b(C)},g=oe(_),S=0;S<E;++S){var K=A[S];K!=null&&(k=v.get(A[S]),k._pos=S,k.onsuccess=M,k.onerror=g,++I)}I===0&&b(C)})},get:function(y){var w=y.trans,A=y.key;return new Promise(function(b,_){b=N(b);var v=w.objectStore(h),E=v.get(A);E.onsuccess=function(C){return b(C.target.result)},E.onerror=oe(_)})},query:d(s),openCursor:p,count:function(y){var w=y.query,A=y.trans,b=w.index,_=w.range;return new Promise(function(v,E){var C=A.objectStore(h),I=b.isPrimaryKey?C:C.index(b.name),D=i(_),k=D?I.count(D):I.count();k.onsuccess=N(function(M){return v(M.target.result)}),k.onerror=oe(E)})}}}var o=r(e,n),u=o.schema,s=o.hasGetAll,c=u.tables.map(function(l){return a(l)}),f={};return c.forEach(function(l){return f[l.name]=l}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(l){var h=f[l];if(!h)throw new Error("Table '"+l+"' not found");return f[l]},MIN_KEY:-1/0,MAX_KEY:Ze(t),schema:u}}function ta(e,t){return t.reduce(function(n,r){var i=r.create;return F(F({},n),i(n))},e)}function na(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var a=ta(ea(t,i,r),e.dbcore);return{dbcore:a}}function xn(e,t){var n=e._novip,r=t.db,i=na(n._middlewares,r,n._deps,t);n.core=i.dbcore,n.tables.forEach(function(a){var o=a.name;n.core.schema.tables.some(function(u){return u.name===o})&&(a.core=n.core.table(o),n[o]instanceof n.Table&&(n[o].core=a.core))})}function It(e,t,n,r){var i=e._novip;n.forEach(function(a){var o=r[a];t.forEach(function(u){var s=_n(u,a);(!s||"value"in s&&s.value===void 0)&&(u===i.Transaction.prototype||u instanceof i.Transaction?pe(u,a,{get:function(){return this.table(a)},set:function(c){lr(this,a,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):u[a]=new i.Table(a,o))})})}function cn(e,t){var n=e._novip;t.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function ra(e,t){return e._cfg.version-t._cfg.version}function ia(e,t,n,r){var i=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var o=a._reject.bind(a),u=O.transless||O;_e(function(){O.trans=a,O.transless=u,t===0?(V(i).forEach(function(s){Cn(n,s,i[s].primKey,i[s].indexes)}),xn(e,n),R.follow(function(){return e.on.populate.fire(a)}).catch(o)):aa(e,t,a,n).catch(o)})}function aa(e,t,n,r){var i=e._novip,a=[],o=i._versions,u=i._dbSchema=On(i,i.idbdb,r),s=!1,c=o.filter(function(l){return l._cfg.version>=t});c.forEach(function(l){a.push(function(){var h=u,m=l._cfg.dbschema;fn(i,h,r),fn(i,m,r),u=i._dbSchema=m;var p=Mr(h,m);p.add.forEach(function(_){Cn(r,_[0],_[1].primKey,_[1].indexes)}),p.change.forEach(function(_){if(_.recreate)throw new B.Upgrade("Not yet support for changing primary key");var v=r.objectStore(_.name);_.add.forEach(function(E){return ln(v,E)}),_.change.forEach(function(E){v.deleteIndex(E.name),ln(v,E)}),_.del.forEach(function(E){return v.deleteIndex(E)})});var d=l._cfg.contentUpgrade;if(d&&l._cfg.version>t){xn(i,r),n._memoizedTables={},s=!0;var y=pr(m);p.del.forEach(function(_){y[_]=h[_]}),cn(i,[i.Transaction.prototype]),It(i,[i.Transaction.prototype],V(y),y),n.schema=y;var w=bn(d);w&&Pe();var A,b=R.follow(function(){if(A=d(n),A&&w){var _=ve.bind(null,null);A.then(_,_)}});return A&&typeof A.then=="function"?R.resolve(A):b.then(function(){return A})}}),a.push(function(h){if(!s||!ki){var m=l._cfg.dbschema;ua(m,h)}cn(i,[i.Transaction.prototype]),It(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function f(){return a.length?R.resolve(a.shift()(n.idbtrans)).then(f):R.resolve()}return f().then(function(){oa(u,r)})}function Mr(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],a=t[r];if(!i)n.add.push([r,a]);else{var o={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto&&!Kt)o.recreate=!0,n.change.push(o);else{var u=i.idxByName,s=a.idxByName,c=void 0;for(c in u)s[c]||o.del.push(c);for(c in s){var f=u[c],l=s[c];f?f.src!==l.src&&o.change.push(l):o.add.push(l)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function Cn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return ln(i,a)}),i}function oa(e,t){V(e).forEach(function(n){t.db.objectStoreNames.contains(n)||Cn(t,n,e[n].primKey,e[n].indexes)})}function ua(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function ln(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function On(e,t,n){var r={},i=Ot(t.objectStoreNames,0);return i.forEach(function(a){for(var o=n.objectStore(a),u=o.keyPath,s=un(Fr(u),u||"",!1,!1,!!o.autoIncrement,u&&typeof u!="string",!0),c=[],f=0;f<o.indexNames.length;++f){var l=o.index(o.indexNames[f]);u=l.keyPath;var h=un(l.name,u,!!l.unique,!!l.multiEntry,!1,u&&typeof u!="string",!1);c.push(h)}r[a]=Pr(a,s,c)}),r}function sa(e,t,n){var r=e._novip;r.verno=t.version/10;var i=r._dbSchema=On(r,t,n);r._storeNames=Ot(t.objectStoreNames,0),It(r,[r._allTables],V(i),i)}function ca(e,t){var n=On(e,e.idbdb,t),r=Mr(n,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function fn(e,t,n){for(var r=e._novip,i=n.db.objectStoreNames,a=0;a<i.length;++a){var o=i[a],u=n.objectStore(o);r._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var c=u.indexNames[s],f=u.index(c).keyPath,l=typeof f=="string"?f:"["+Ot(f).join("+")+"]";if(t[o]){var h=t[o].idxByName[l];h&&(h.name=c,delete t[o].idxByName[l],t[o].idxByName[c]=h)}}}typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&L.WorkerGlobalScope&&L instanceof L.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function la(e){return e.split(",").map(function(t,n){t=t.trim();var r=t.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return un(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),q(i),n===0)})}var fa=function(){function e(){}return e.prototype._parseStoresSpec=function(t,n){V(t).forEach(function(r){if(t[r]!==null){var i=la(t[r]),a=i.shift();if(a.multi)throw new B.Schema("Primary key cannot be multi-valued");i.forEach(function(o){if(o.auto)throw new B.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new B.Schema("Index must have a name and cannot be an empty string")}),n[r]=Pr(r,a,i)}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?J(this._cfg.storesSource,t):t;var r=n._versions,i={},a={};return r.forEach(function(o){J(i,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(i,a)}),n._dbSchema=a,cn(n,[n._allTables,n,n.Transaction.prototype]),It(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],V(a),a),n._storeNames=V(a),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=En(this._cfg.contentUpgrade||U,t),this},e}();function ha(e){return it(fa.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Dn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Fn(Bt,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Kn(e){return e&&typeof e.databases=="function"}function da(e){var t=e.indexedDB,n=e.IDBKeyRange;return Kn(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==Bt})}):Dn(t,n).toCollection().primaryKeys()}function pa(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Kn(n)&&t!==Bt&&Dn(n,r).put({name:t}).catch(U)}function va(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Kn(n)&&t!==Bt&&Dn(n,r).delete(t).catch(U)}function hn(e){return _e(function(){return O.letThrough=!0,e()})}function ya(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)})}function ma(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?W(t.dbOpenError):e});ue&&(t.openCanceller._stackHolder=xe()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller;function i(){if(t.openCanceller!==r)throw new B.DatabaseClosed("db.open() was cancelled")}var a=t.dbReadyResolve,o=null,u=!1;return R.race([r,(typeof navigator=="undefined"?R.resolve():ya()).then(function(){return new R(function(s,c){if(i(),!n)throw new B.MissingAPI;var f=e.name,l=t.autoSchema?n.open(f):n.open(f,Math.round(e.verno*10));if(!l)throw new B.MissingAPI;l.onerror=oe(c),l.onblocked=N(e._fireOnBlocked),l.onupgradeneeded=N(function(h){if(o=l.transaction,t.autoSchema&&!e._options.allowEmptyDB){l.onerror=Xe,o.abort(),l.result.close();var m=n.deleteDatabase(f);m.onsuccess=m.onerror=N(function(){c(new B.NoSuchDatabase("Database "+f+" doesnt exist"))})}else{o.onerror=oe(c);var p=h.oldVersion>Math.pow(2,62)?0:h.oldVersion;u=p<1,e._novip.idbdb=l.result,ia(e,p/10,o,c)}},c),l.onsuccess=N(function(){o=null;var h=e._novip.idbdb=l.result,m=Ot(h.objectStoreNames);if(m.length>0)try{var p=h.transaction(Zi(m),"readonly");t.autoSchema?sa(e,h,p):(fn(e,e._dbSchema,p),ca(e,p)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),xn(e,p)}catch{}We.push(e),h.onversionchange=N(function(d){t.vcFired=!0,e.on("versionchange").fire(d)}),h.onclose=N(function(d){e.on("close").fire(d)}),u&&pa(e._deps,f),s()},c)})})]).then(function(){return i(),t.onReadyBeingFired=[],R.resolve(hn(function(){return e.on.ready.fire(e.vip)})).then(function s(){if(t.onReadyBeingFired.length>0){var c=t.onReadyBeingFired.reduce(En,U);return t.onReadyBeingFired=[],R.resolve(hn(function(){return c(e.vip)})).then(s)}})}).finally(function(){t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(function(){return e}).catch(function(s){t.dbOpenError=s;try{o&&o.abort()}catch{}return r===t.openCanceller&&e._close(),W(s)}).finally(function(){t.openComplete=!0,a()})}function dn(e){var t=function(o){return e.next(o)},n=function(o){return e.throw(o)},r=a(t),i=a(n);function a(o){return function(u){var s=o(u),c=s.value;return s.done?c:!c||typeof c.then!="function"?q(c)?Promise.all(c).then(r,i):r(c):c.then(r,i)}}return a(t)()}function ga(e,t,n){var r=arguments.length;if(r<2)throw new B.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=vr(i);return[e,a,n]}function Ur(e,t,n,r,i){return R.resolve().then(function(){var a=O.transless||O,o=e._createTransaction(t,n,e._dbSchema,r),u={trans:o,transless:a};if(r)o.idbtrans=r.idbtrans;else try{o.create(),e._state.PR1398_maxLoop=3}catch(l){return l.name===An.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return Ur(e,t,n,null,i)})):W(l)}var s=bn(i);s&&Pe();var c,f=R.follow(function(){if(c=i.call(o,o),c)if(s){var l=ve.bind(null,null);c.then(l,l)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=dn(c))},u);return(c&&typeof c.then=="function"?R.resolve(c).then(function(l){return o.active?l:W(new B.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):f.then(function(){return c})).then(function(l){return r&&o._resolve(),o._completion.then(function(){return l})}).catch(function(l){return o._reject(l),W(l)})})}function lt(e,t,n){for(var r=q(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function _a(e){return F(F({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},a=[];function o(d,y,w){var A=Ye(d),b=i[A]=i[A]||[],_=d==null?0:typeof d=="string"?1:d.length,v=y>0,E=F(F({},w),{isVirtual:v,keyTail:y,keyLength:_,extractKey:sn(d),unique:!v&&w.unique});if(b.push(E),E.isPrimaryKey||a.push(E),_>1){var C=_===2?d[0]:d.slice(0,_-1);o(C,y+1,w)}return b.sort(function(I,D){return I.keyTail-D.keyTail}),E}var u=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var s=0,c=r.indexes;s<c.length;s++){var f=c[s];o(f.keyPath,0,f)}function l(d){var y=i[Ye(d)];return y&&y[0]}function h(d,y){return{type:d.type===1?2:d.type,lower:lt(d.lower,d.lowerOpen?e.MAX_KEY:e.MIN_KEY,y),lowerOpen:!0,upper:lt(d.upper,d.upperOpen?e.MIN_KEY:e.MAX_KEY,y),upperOpen:!0}}function m(d){var y=d.query.index;return y.isVirtual?F(F({},d),{query:{index:y,range:h(d.query.range,y.keyTail)}}):d}var p=F(F({},n),{schema:F(F({},r),{primaryKey:u,indexes:a,getIndexByKeyPath:l}),count:function(d){return n.count(m(d))},query:function(d){return n.query(m(d))},openCursor:function(d){var y=d.query.index,w=y.keyTail,A=y.isVirtual,b=y.keyLength;if(!A)return n.openCursor(d);function _(v){function E(I){I!=null?v.continue(lt(I,d.reverse?e.MAX_KEY:e.MIN_KEY,w)):d.unique?v.continue(v.key.slice(0,b).concat(d.reverse?e.MIN_KEY:e.MAX_KEY,w)):v.continue()}var C=Object.create(v,{continue:{value:E},continuePrimaryKey:{value:function(I,D){v.continuePrimaryKey(lt(I,e.MAX_KEY,w),D)}},primaryKey:{get:function(){return v.primaryKey}},key:{get:function(){var I=v.key;return b===1?I[0]:I.slice(0,b)}},value:{get:function(){return v.value}}});return C}return n.openCursor(m(d)).then(function(v){return v&&_(v)})}});return p}})}var ba={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:_a};function Bn(e,t,n,r){return n=n||{},r=r||"",V(e).forEach(function(i){if(!ne(t,i))n[r+i]=void 0;else{var a=e[i],o=t[i];if(typeof a=="object"&&typeof o=="object"&&a&&o){var u=Gt(a),s=Gt(o);u!==s?n[r+i]=t[i]:u==="Object"?Bn(a,o,n,r+i+"."):a!==o&&(n[r+i]=t[i])}else a!==o&&(n[r+i]=t[i])}}),V(t).forEach(function(i){ne(e,i)||(n[r+i]=t[i])}),n}function wa(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Aa={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return F(F({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,i=F(F({},n),{mutate:function(a){var o=O.trans,u=o.table(t).hook,s=u.deleting,c=u.creating,f=u.updating;switch(a.type){case"add":if(c.fire===U)break;return o._promise("readwrite",function(){return l(a)},!0);case"put":if(c.fire===U&&f.fire===U)break;return o._promise("readwrite",function(){return l(a)},!0);case"delete":if(s.fire===U)break;return o._promise("readwrite",function(){return l(a)},!0);case"deleteRange":if(s.fire===U)break;return o._promise("readwrite",function(){return h(a)},!0)}return n.mutate(a);function l(p){var d=O.trans,y=p.keys||wa(r,p);if(!y)throw new Error("Keys missing");return p=p.type==="add"||p.type==="put"?F(F({},p),{keys:y}):F({},p),p.type!=="delete"&&(p.values=Yt([],p.values,!0)),p.keys&&(p.keys=Yt([],p.keys,!0)),Ea(n,p,y).then(function(w){var A=y.map(function(b,_){var v=w[_],E={onerror:null,onsuccess:null};if(p.type==="delete")s.fire.call(E,b,v,d);else if(p.type==="add"||v===void 0){var C=c.fire.call(E,b,p.values[_],d);b==null&&C!=null&&(b=C,p.keys[_]=b,r.outbound||ie(p.values[_],r.keyPath,b))}else{var I=Bn(v,p.values[_]),D=f.fire.call(E,I,b,v,d);if(D){var k=p.values[_];Object.keys(D).forEach(function(M){ne(k,M)?k[M]=D[M]:ie(k,M,D[M])})}}return E});return n.mutate(p).then(function(b){for(var _=b.failures,v=b.results,E=b.numFailures,C=b.lastResult,I=0;I<y.length;++I){var D=v?v[I]:y[I],k=A[I];D==null?k.onerror&&k.onerror(_[I]):k.onsuccess&&k.onsuccess(p.type==="put"&&w[I]?p.values[I]:D)}return{failures:_,results:v,numFailures:E,lastResult:C}}).catch(function(b){return A.forEach(function(_){return _.onerror&&_.onerror(b)}),Promise.reject(b)})})}function h(p){return m(p.trans,p.range,1e4)}function m(p,d,y){return n.query({trans:p,values:!1,query:{index:r,range:d},limit:y}).then(function(w){var A=w.result;return l({type:"delete",keys:A,trans:p}).then(function(b){return b.numFailures>0?Promise.reject(b.failures[0]):A.length<y?{failures:[],numFailures:0,lastResult:void 0}:m(p,F(F({},d),{lower:A[A.length-1],lowerOpen:!0}),y)})})}}});return i}})}};function Ea(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function Lr(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)Q(t.keys[i],e[a])===0&&(r.push(n?Je(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var Sa={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return F(F({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Lr(r.keys,r.trans._cache,r.cache==="clone");return i?R.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Je(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},jt;function kn(e){return!("from"in e)}var ce=function(e,t){if(this)J(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new ce;return e&&"d"in e&&J(n,e),n}};Be(ce.prototype,(jt={add:function(e){return Rt(this,e),this},addKey:function(e){return Qe(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Qe(t,n,n)}),this}},jt[$t]=function(){return pn(this)},jt));function Qe(e,t,n){var r=Q(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(kn(e))return J(e,{from:t,to:n,d:1});var i=e.l,a=e.r;if(Q(n,e.from)<0)return i?Qe(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Qn(e);if(Q(t,e.to)>0)return a?Qe(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Qn(e);Q(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),Q(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var o=!e.r;i&&!e.l&&Rt(e,i),a&&o&&Rt(e,a)}}function Rt(e,t){function n(r,i){var a=i.from,o=i.to,u=i.l,s=i.r;Qe(r,a,o),u&&n(r,u),s&&n(r,s)}kn(t)||n(e,t)}function Ta(e,t){var n=pn(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=pn(e),o=a.next(i.from),u=o.value;!r.done&&!o.done;){if(Q(u.from,i.to)<=0&&Q(u.to,i.from)>=0)return!0;Q(i.from,u.from)<0?i=(r=n.next(u.from)).value:u=(o=a.next(i.from)).value}return!1}function pn(e){var t=kn(e)?null:{s:0,n:e};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&Q(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||Q(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Qn(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",o=F({},e),u=e[i];e.from=u.from,e.to=u.to,e[i]=u[i],o[i]=u[a],e[a]=o,o.d=Jn(o)}e.d=Jn(e)}function Jn(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}var Ia={stack:"dbcore",level:0,create:function(e){var t=e.schema.name,n=new ce(e.MIN_KEY,e.MAX_KEY);return F(F({},e),{table:function(r){var i=e.table(r),a=i.schema,o=a.primaryKey,u=o.extractKey,s=o.outbound,c=F(F({},i),{mutate:function(h){var m=h.trans,p=m.mutatedParts||(m.mutatedParts={}),d=function(C){var I="idb://"+t+"/"+r+"/"+C;return p[I]||(p[I]=new ce)},y=d(""),w=d(":dels"),A=h.type,b=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[],_=b[0],v=b[1],E=h.trans._cache;return i.mutate(h).then(function(C){if(q(_)){A!=="delete"&&(_=C.results),y.addKeys(_);var I=Lr(_,E);!I&&A!=="add"&&w.addKeys(_),(I||v)&&Ra(d,a,I,v)}else if(_){var D={from:_.lower,to:_.upper};w.add(D),y.add(D)}else y.add(n),w.add(n),a.indexes.forEach(function(k){return d(k.name).add(n)});return C})}}),f=function(h){var m,p,d=h.query,y=d.index,w=d.range;return[y,new ce((m=w.lower)!==null&&m!==void 0?m:e.MIN_KEY,(p=w.upper)!==null&&p!==void 0?p:e.MAX_KEY)]},l={get:function(h){return[o,new ce(h.key)]},getMany:function(h){return[o,new ce().addKeys(h.keys)]},count:f,query:f,openCursor:f};return V(l).forEach(function(h){c[h]=function(m){var p=O.subscr;if(p){var d=function(E){var C="idb://"+t+"/"+r+"/"+E;return p[C]||(p[C]=new ce)},y=d(""),w=d(":dels"),A=l[h](m),b=A[0],_=A[1];if(d(b.name||"").add(_),!b.isPrimaryKey)if(h==="count")w.add(n);else{var v=h==="query"&&s&&m.values&&i.query(F(F({},m),{values:!1}));return i[h].apply(this,arguments).then(function(E){if(h==="query"){if(s&&m.values)return v.then(function(k){var M=k.result;return y.addKeys(M),E});var C=m.values?E.result.map(u):E.result;m.values?y.addKeys(C):w.addKeys(C)}else if(h==="openCursor"){var I=E,D=m.values;return I&&Object.create(I,{key:{get:function(){return w.addKey(I.primaryKey),I.key}},primaryKey:{get:function(){var k=I.primaryKey;return w.addKey(k),k}},value:{get:function(){return D&&y.addKey(I.primaryKey),I.value}}})}return E})}}return i[h].apply(this,arguments)}}),c}})}};function Ra(e,t,n,r){function i(a){var o=e(a.name||"");function u(c){return c!=null?a.extractKey(c):null}var s=function(c){return a.multiEntry&&q(c)?c.forEach(function(f){return o.addKey(f)}):o.addKey(c)};(n||r).forEach(function(c,f){var l=n&&u(n[f]),h=r&&u(r[f]);Q(l,h)!==0&&(l!=null&&s(l),h!=null&&s(h))})}t.indexes.forEach(i)}var Fn=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=F({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:U,dbReadyPromise:null,cancelOpen:U,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};o.dbReadyPromise=new R(function(u){o.dbReadyResolve=u}),o.openCanceller=new R(function(u,s){o.cancelOpen=s}),this._state=o,this.name=t,this.on=rt(this,"populate","blocked","versionchange","close",{ready:[En,U]}),this.on.ready.subscribe=fr(this.on.ready.subscribe,function(u){return function(s,c){e.vip(function(){var f=r._state;if(f.openComplete)f.dbOpenError||R.resolve().then(s),c&&u(s);else if(f.onReadyBeingFired)f.onReadyBeingFired.push(s),c&&u(s);else{u(s);var l=r;c||u(function h(){l.on.ready.unsubscribe(s),l.on.ready.unsubscribe(h)})}})}}),this.Collection=Vi(this),this.Table=Mi(this),this.Transaction=qi(this),this.Version=ha(this),this.WhereClause=$i(this),this.on("versionchange",function(u){u.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(u){!u.newVersion||u.newVersion<u.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+u.oldVersion/10)}),this._maxKey=Ze(n.IDBKeyRange),this._createTransaction=function(u,s,c,f){return new r.Transaction(u,s,c,r._options.chromeTransactionDurability,f)},this._fireOnBlocked=function(u){r.on("blocked").fire(u),We.filter(function(s){return s.name===r.name&&s!==r&&!s._state.vcFired}).map(function(s){return s.on("versionchange").fire(u)})},this.use(ba),this.use(Aa),this.use(Ia),this.use(Sa),this.vip=Object.create(this,{_vip:{value:!0}}),a.forEach(function(u){return u(r)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new B.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new B.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(i){return i._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(ra),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||O.letThrough||this._vip)?t():new R(function(r,i){if(n._state.openComplete)return i(new B.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new B.DatabaseClosed);return}n.open().catch(U)}n._state.dbReadyPromise.then(r,i)}).then(t)},e.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,a=t.name;a&&this.unuse({stack:n,name:a});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:r,level:i==null?10:i,name:a}),o.sort(function(u,s){return u.level-s.level}),this},e.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},e.prototype.open=function(){return ma(this)},e.prototype._close=function(){var t=this._state,n=We.indexOf(this);if(n>=0&&We.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new R(function(r){t.dbReadyResolve=r}),t.openCanceller=new R(function(r,i){t.cancelOpen=i})},e.prototype.close=function(){this._close();var t=this._state;this._options.autoOpen=!1,t.dbOpenError=new B.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)},e.prototype.delete=function(){var t=this,n=arguments.length>0,r=this._state;return new R(function(i,a){var o=function(){t.close();var u=t._deps.indexedDB.deleteDatabase(t.name);u.onsuccess=N(function(){va(t._deps,t.name),i()}),u.onerror=oe(a),u.onblocked=t._fireOnBlocked};if(n)throw new B.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return V(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=ga.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,r){var i=this,a=O.trans;(!a||a.db!==this||t.indexOf("!")!==-1)&&(a=null);var o=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var u,s;try{if(s=n.map(function(f){var l=f instanceof i.Table?f.name:f;if(typeof l!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return l}),t=="r"||t===Pt)u=Pt;else if(t=="rw"||t==Mt)u=Mt;else throw new B.InvalidArgument("Invalid transaction mode: "+t);if(a){if(a.mode===Pt&&u===Mt)if(o)a=null;else throw new B.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&s.forEach(function(f){if(a&&a.storeNames.indexOf(f)===-1)if(o)a=null;else throw new B.SubTransaction("Table "+f+" not included in parent transaction.")}),o&&a&&!a.active&&(a=null)}}catch(f){return a?a._promise(null,function(l,h){h(f)}):W(f)}var c=Ur.bind(null,this,u,s,a,r);return a?a._promise(u,c,"lock"):O.trans?Me(O.transless,function(){return i._whenReady(c)}):this._whenReady(c)},e.prototype.table=function(t){if(!ne(this._allTables,t))throw new B.InvalidTable("Table "+t+" does not exist");return this._allTables[t]},e}(),xa=typeof Symbol!="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable",Ca=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,r){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:r}:t)},e.prototype[xa]=function(){return this},e}();function Nr(e,t){return V(t).forEach(function(n){var r=e[n]||(e[n]=new ce);Rt(r,t[n])}),e}function Oa(e){return new Ca(function(t){var n=bn(e);function r(m){n&&Pe();var p=function(){return _e(e,{subscr:m,trans:null})},d=O.trans?Me(O.transless,p):p();return n&&d.then(ve,ve),d}var i=!1,a={},o={},u={get closed(){return i},unsubscribe:function(){i=!0,we.storagemutated.unsubscribe(l)}};t.start&&t.start(u);var s=!1,c=!1;function f(){return V(o).some(function(m){return a[m]&&Ta(a[m],o[m])})}var l=function(m){Nr(a,m),f()&&h()},h=function(){if(!(s||i)){a={};var m={},p=r(m);c||(we(qe,l),c=!0),s=!0,Promise.resolve(p).then(function(d){s=!1,!i&&(f()?h():(a={},o=m,t.next&&t.next(d)))},function(d){s=!1,t.error&&t.error(d),u.unsubscribe()})}};return h(),u})}var vn;try{vn={indexedDB:L.indexedDB||L.mozIndexedDB||L.webkitIndexedDB||L.msIndexedDB,IDBKeyRange:L.IDBKeyRange||L.webkitIDBKeyRange}}catch{vn={indexedDB:null,IDBKeyRange:null}}var Ae=Fn;Be(Ae,F(F({},Dt),{delete:function(e){var t=new Ae(e,{addons:[]});return t.delete()},exists:function(e){return new Ae(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return da(Ae.dependencies).then(e)}catch{return W(new B.MissingAPI)}},defineClass:function(){function e(t){J(this,t)}return e},ignoreTransaction:function(e){return O.trans?Me(O.transless,e):e()},vip:hn,async:function(e){return function(){try{var t=dn(e.apply(this,arguments));return!t||typeof t.then!="function"?R.resolve(t):t}catch(n){return W(n)}}},spawn:function(e,t,n){try{var r=dn(e.apply(n,t||[]));return!r||typeof r.then!="function"?R.resolve(r):r}catch(i){return W(i)}},currentTransaction:{get:function(){return O.trans||null}},waitFor:function(e,t){var n=R.resolve(typeof e=="function"?Ae.ignoreTransaction(e):e).timeout(t||6e4);return O.trans?O.trans.waitFor(n):n},Promise:R,debug:{get:function(){return ue},set:function(e){mr(e,e==="dexie"?function(){return!0}:Dr)}},derive:ke,extend:J,props:Be,override:fr,Events:rt,on:we,liveQuery:Oa,extendObservabilitySet:Nr,getByKeyPath:de,setByKeyPath:ie,delByKeyPath:si,shallowClone:pr,deepClone:Je,getObjectDiff:Bn,cmp:Q,asap:hr,minKey:on,addons:[],connections:We,errnames:An,dependencies:vn,semVer:Hn,version:Hn.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})}));Ae.maxKey=Ze(Ae.dependencies.IDBKeyRange);typeof dispatchEvent!="undefined"&&typeof addEventListener!="undefined"&&(we(qe,function(e){if(!he){var t;Kt?(t=document.createEvent("CustomEvent"),t.initCustomEvent(ge,!0,!0,e)):t=new CustomEvent(ge,{detail:e}),he=!0,dispatchEvent(t),he=!1}}),addEventListener(ge,function(e){var t=e.detail;he||xt(t)}));function xt(e){var t=he;try{he=!0,we.storagemutated.fire(e)}finally{he=t}}var he=!1;if(typeof BroadcastChannel!="undefined"){var er=new BroadcastChannel(ge);we(qe,function(e){he||er.postMessage(e)}),er.onmessage=function(e){e.data&&xt(e.data)}}else if(typeof self!="undefined"&&typeof navigator!="undefined"){we(qe,function(e){try{he||(typeof localStorage!="undefined"&&localStorage.setItem(ge,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&Yt([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(t){return t.postMessage({type:ge,changedParts:e})}))}catch{}}),typeof addEventListener!="undefined"&&addEventListener("storage",function(e){if(e.key===ge){var t=JSON.parse(e.newValue);t&&xt(t.changedParts)}});var tr=self.document&&navigator.serviceWorker;tr&&tr.addEventListener("message",Da)}function Da(e){var t=e.data;t&&t.type===ge&&xt(t.changedParts)}R.rejectionMapper=mi;mr(ue,Dr);const fe=new Fn("GOL");fe.version(1).stores({saves:`
      ++id,
      data,
      stamp
    `});const z=document.querySelector(".main-canvas"),yn=z.getContext("2d"),jr=document.querySelector(".zoom-container"),Pn=document.querySelector(".zoom-canvas"),_t=Pn.getContext("2d"),Ct=document.querySelector(".run-btn"),Vr=document.querySelector(".step-btn"),Ka=document.querySelector(".save-btn"),Ve=document.querySelector("#saves"),Ba=document.querySelector(".clear-btn"),ka=document.querySelector(".drop-btn"),Vt=()=>{fe.transaction("r",fe.saves,async()=>{const e=await fe.saves.toArray();Ve.innerHTML="";const t=document.createElement("option");t.selected=!0,t.hidden=!0,t.disabled=!0,t.value="",Ve.appendChild(t),e.forEach(({stamp:n,id:r})=>{const i=document.createElement("option");i.value=r,i.text=`#${r} ${n}`,Ve.appendChild(i)}),t.text=e.length?"Choose one":"Save something",Ve.disabled=e.length<1})},zt=-8,mn=-4,nr=0,rr=1,Fa=1<<0,ft=1<<1,ht=1<<2,Pa=6,ir=1<<11,ar=1<<12,Ma=1<<14,Ua=0,Wt=4,or=8,La=12,ur=12,Na=16,ja="Operation requires compiling with --exportTable",Va="Operation requires compiling with --exportRuntime",Ue=()=>{throw Error(Va)},za=typeof BigUint64Array!="undefined",Le=Symbol(),Wa=192,sr=1024,Ya=new TextDecoder("utf-16le",{fatal:!0});Object.hasOwn=Object.hasOwn||function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function zr(e,t){let n=new Uint32Array(e)[t+mn>>>2]>>>1;const r=new Uint16Array(e,t,n);if(n<=Wa)return String.fromCharCode(...r);try{return Ya.decode(r)}catch{let i="",a=0;for(;n-a>sr;)i+=String.fromCharCode(...r.subarray(a,a+=sr));return i+String.fromCharCode(...r.subarray(a))}}function Mn(e){const t={};function n(i,a){return i?zr(i.buffer,a):"<yet unknown>"}const r=e.env=e.env||{};return r.abort=r.abort||function(a,o,u,s){const c=t.memory||r.memory;throw Error(`abort: ${n(c,a)} at ${n(c,o)}:${u}:${s}`)},r.trace=r.trace||function(a,o,...u){const s=t.memory||r.memory;console.log(`trace: ${n(s,a)}${o?" ":""}${u.slice(0,o).join(", ")}`)},r.seed=r.seed||Date.now,e.Math=e.Math||Math,e.Date=e.Date||Date,t}function Un(e,t){const n=t.exports,r=n.memory,i=n.table,a=n.__new||Ue,o=n.__pin||Ue,u=n.__unpin||Ue,s=n.__collect||Ue,c=n.__rtti_base,f=c?g=>g[c>>>2]:Ue;e.__new=a,e.__pin=o,e.__unpin=u,e.__collect=s;function l(g){const S=new Uint32Array(r.buffer);if((g>>>=0)>=f(S))throw Error(`invalid id: ${g}`);return S[(c+4>>>2)+(g<<1)]}function h(g){const S=new Uint32Array(r.buffer);if((g>>>=0)>=f(S))throw Error(`invalid id: ${g}`);return S[(c+4>>>2)+(g<<1)+1]}function m(g){const S=l(g);if(!(S&(Fa|ft|ht)))throw Error(`not an array: ${g}, flags=${S}`);return S}function p(g){return 31-Math.clz32(g>>>Pa&31)}function d(g){if(g==null)return 0;const S=g.length,K=a(S<<1,rr),T=new Uint16Array(r.buffer);for(var P=0,j=K>>>1;P<S;++P)T[j+P]=g.charCodeAt(P);return K}e.__newString=d;function y(g){if(g==null)return 0;const S=new Uint8Array(g),K=a(S.length,nr);return new Uint8Array(r.buffer).set(S,K),K}e.__newArrayBuffer=y;function w(g){if(!g)return null;const S=r.buffer;if(new Uint32Array(S)[g+zt>>>2]!==rr)throw Error(`not a string: ${g}`);return zr(S,g)}e.__getString=w;function A(g,S,K){const T=r.buffer;if(K)switch(g){case 2:return new Float32Array(T);case 3:return new Float64Array(T)}else switch(g){case 0:return new(S?Int8Array:Uint8Array)(T);case 1:return new(S?Int16Array:Uint16Array)(T);case 2:return new(S?Int32Array:Uint32Array)(T);case 3:return new(S?BigInt64Array:BigUint64Array)(T)}throw Error(`unsupported align: ${g}`)}function b(g,S=0){const K=S,T=m(g),P=p(T),j=typeof K!="number",Z=j?K.length:K,H=a(Z<<P,T&ht?g:nr);let $;if(T&ht)$=H;else{o(H);const G=a(T&ft?Na:La,g);u(H);const Y=new Uint32Array(r.buffer);Y[G+Ua>>>2]=H,Y[G+Wt>>>2]=H,Y[G+or>>>2]=Z<<P,T&ft&&(Y[G+ur>>>2]=Z),$=G}if(j){const G=A(P,T&ir,T&ar),Y=H>>>P;if(T&Ma)for(let ae=0;ae<Z;++ae)G[Y+ae]=K[ae];else G.set(K,Y)}return $}e.__newArray=b;function _(g){const S=new Uint32Array(r.buffer),K=S[g+zt>>>2],T=m(K),P=p(T);let j=T&ht?g:S[g+Wt>>>2];const Z=T&ft?S[g+ur>>>2]:S[j+mn>>>2]>>>P;return A(P,T&ir,T&ar).subarray(j>>>=P,j+Z)}e.__getArrayView=_;function v(g){const S=_(g),K=S.length,T=new Array(K);for(let P=0;P<K;P++)T[P]=S[P];return T}e.__getArray=v;function E(g){const S=r.buffer,K=new Uint32Array(S)[g+mn>>>2];return S.slice(g,g+K)}e.__getArrayBuffer=E;function C(g){if(!i)throw Error(ja);const S=new Uint32Array(r.buffer)[g>>>2];return i.get(S)}e.__getFunction=C;function I(g,S,K){return new g(D(g,S,K))}function D(g,S,K){const T=r.buffer,P=new Uint32Array(T);return new g(T,P[K+Wt>>>2],P[K+or>>>2]>>>S)}function k(g,S,K){e[`__get${S}`]=I.bind(null,g,K),e[`__get${S}View`]=D.bind(null,g,K)}[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array].forEach(g=>{k(g,g.name,31-Math.clz32(g.BYTES_PER_ELEMENT))}),za&&[BigUint64Array,BigInt64Array].forEach(g=>{k(g,g.name.slice(3),3)});function M(g,S){const K=new Uint32Array(r.buffer);let T=K[g+zt>>>2];if(T<=f(K))do{if(T==S)return!0;T=h(T)}while(T);return!1}return e.__instanceof=M,e.memory=e.memory||r,e.table=e.table||i,$r(n,e)}function Wr(e){return typeof Response!="undefined"&&e instanceof Response}function Yr(e){return e instanceof WebAssembly.Module}async function Hr(e,t={}){if(Wr(e=await e))return Gr(e,t);const n=Yr(e)?e:await WebAssembly.compile(e),r=Mn(t),i=await WebAssembly.instantiate(n,t),a=Un(r,i);return{module:n,instance:i,exports:a}}function Ha(e,t={}){const n=Yr(e)?e:new WebAssembly.Module(e),r=Mn(t),i=new WebAssembly.Instance(n,t),a=Un(r,i);return{module:n,instance:i,exports:a}}async function Gr(e,t={}){if(!WebAssembly.instantiateStreaming)return Hr(Wr(e=await e)?e.arrayBuffer():e,t);const n=Mn(t),r=await WebAssembly.instantiateStreaming(e,t),i=Un(n,r.instance);return jn(Nn({},r),{exports:i})}function $r(e,t={}){const n=e.__argumentsLength?r=>{e.__argumentsLength.value=r}:e.__setArgumentsLength||e.__setargc||(()=>{});for(let r of Object.keys(e)){const i=e[r];let a=r.split("."),o=t;for(;a.length>1;){let c=a.shift();Object.hasOwn(o,c)||(o[c]={}),o=o[c]}let u=a[0],s=u.indexOf("#");if(s>=0){const c=u.substring(0,s),f=o[c];if(typeof f=="undefined"||!f.prototype){const l=function(...h){return l.wrap(l.prototype.constructor(0,...h))};l.prototype={valueOf(){return this[Le]}},l.wrap=function(h){return Object.create(l.prototype,{[Le]:{value:h,writable:!1}})},f&&Object.getOwnPropertyNames(f).forEach(h=>Object.defineProperty(l,h,Object.getOwnPropertyDescriptor(f,h))),o[c]=l}if(u=u.substring(s+1),o=o[c].prototype,/^(get|set):/.test(u)){if(!Object.hasOwn(o,u=u.substring(4))){let l=e[r.replace("set:","get:")],h=e[r.replace("get:","set:")];Object.defineProperty(o,u,{get(){return l(this[Le])},set(m){h(this[Le],m)},enumerable:!0})}}else u==="constructor"?(o[u]=function(...l){return n(l.length),i(...l)}).original=i:(o[u]=function(...l){return n(l.length),i(this[Le],...l)}).original=i}else/^(get|set):/.test(u)?Object.hasOwn(o,u=u.substring(4))||Object.defineProperty(o,u,{get:e[r.replace("set:","get:")],set:e[r.replace("get:","set:")],enumerable:!0}):typeof i=="function"&&i!==n?(o[u]=(...c)=>(n(c.length),i(...c))).original=i:o[u]=i}return t}var Ga={instantiate:Hr,instantiateSync:Ha,instantiateStreaming:Gr,demangle:$r};class $a{constructor(){ee(this,"RGB_ALIVE");ee(this,"RGB_DEAD");ee(this,"SIZE_BIT_OFFSET");ee(this,"SUB_WIDTH");ee(this,"ZOOM_CANVAS_OFFSET");ee(this,"positions");ee(this,"size");ee(this,"byteSize");ee(this,"width");ee(this,"height");ee(this,"isRunning");ee(this,"pressed");this.SUB_WIDTH=50,this.ZOOM_CANVAS_OFFSET=17600,this.positions={prevX:null,prevY:null,mouseX:0,mouseY:0}}set(t,n){return this[t]=n}}const x=new $a;x.set("isRunning",!1);Ct.innerHTML="Start";x.set("RGB_ALIVE",16619813);x.set("RGB_DEAD",2171169);const Xr=z.getBoundingClientRect(),qr=()=>{x.set("isRunning",!x.isRunning),Ct.innerHTML=x.isRunning?"Stop":"Start",Vr.disabled=x.isRunning,Ct.blur()};Ct.addEventListener("click",qr);x.set("SIZE_BIT_OFFSET",2);x.set("width",Xr.width>>>x.SIZE_BIT_OFFSET);x.set("height",Xr.height>>>x.SIZE_BIT_OFFSET);x.set("size",x.width*x.height);x.set("byteSize",x.size*2<<2);z.width=x.width;z.height=x.height;yn.imageSmoothingEnabled=!1;jr.style.width="200px";jr.style.height="200px";Pn.width=x.width;Pn.height=x.height;_t.imageSmoothingEnabled=!1;const gn=new WebAssembly.Memory({initial:(x.byteSize+65535&-65536)>>>16}),Xa={env:{memory:gn,abort:(e,t,n,r)=>console.error(`Error at ${n}:${r}`,e),_log:console.log,seed:Math.random},imports:{log:console.log},config:{BGR_ALIVE:cr(x.RGB_ALIVE)|1,BGR_DEAD:cr(x.RGB_DEAD)&-2}};Ga.instantiate(fetch("build/release.wasm"),Xa).then(e=>{const t=e.exports;x.set("pressed",!1),t.init(x.width,x.height);const n=new Uint32Array(gn.buffer),r=()=>{n.copyWithin(0,x.size,x.size+x.size),t.step()};Vr.onclick=r;function i(){n.fill(0),_t.clearRect(0,0,z.width,z.height)}Ba.onclick=()=>{i()},Vt(),Ve.onchange=c=>{const f=Number(c.target.value);fe.transaction("r",fe.saves,async()=>{const{data:l}=await fe.saves.get(f);i(),n.set(l)})},Ka.onclick=()=>{const c=new Uint32Array(gn.buffer.slice(0)),f=new Date,l=`${f.toDateString()} | ${f.toLocaleTimeString()}`;fe.saves.put({data:c,stamp:l}).then(()=>{Vt()})},ka.onclick=()=>{fe.saves.clear().then(()=>{Vt()})},function c(){setTimeout(c,1e3/30),x.isRunning&&(n.copyWithin(0,x.size,x.size+x.size),t.step())}();const a=z.width/z.height,o=z.clientWidth/x.width,u=yn.createImageData(x.width,x.height),s=new Uint32Array(u.data.buffer);(function c(){requestAnimationFrame(c),s.set(n.subarray(x.size,x.size+x.size)),yn.putImageData(u,0,0),_t.drawImage(z,x.positions.mouseX-2,x.positions.mouseY-2,x.SUB_WIDTH,x.SUB_WIDTH*a,0,0,z.width+(x.ZOOM_CANVAS_OFFSET>>>x.SIZE_BIT_OFFSET),z.width+(x.ZOOM_CANVAS_OFFSET>>>x.SIZE_BIT_OFFSET))})(),[[z,"mousedown"],[z,"touchstart"]].forEach(c=>c[0].addEventListener(c[1],()=>x.pressed=!0)),[[document,"mouseup"],[document,"touchend"]].forEach(c=>c[0].addEventListener(c[1],()=>{x.pressed=!1,x.positions.prevX=null,x.positions.prevY=null})),[[z,"mousemove"],[z,"touchmove"],[z,"mousedown"]].forEach(c=>c[0].addEventListener(c[1],f=>{let l;if("touches"in f){if(f.touches.length>1)return;l=f.touches[0]}else l=f;const h=l.x/o>>>0,m=l.y/o>>>0;x.positions.mouseX=h,x.positions.mouseY=m,_t.clearRect(0,0,z.width,z.height),!!x.pressed&&(h!==x.positions.prevX||m!==x.positions.prevY)&&(x.positions.prevX=h,x.positions.prevY=m,n.copyWithin(0,x.size,x.size+x.size),t.drawAtPos(l.x>>>x.SIZE_BIT_OFFSET,l.y>>>x.SIZE_BIT_OFFSET))})),document.addEventListener("keypress",c=>{const{code:f}=c;switch(f){case"Space":qr();break;case"KeyS":r();break}})});function cr(e){return e>>>16&255|e&65280|(e&255)<<16}
